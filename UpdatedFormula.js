let arg ={
    "duration": 97560,
    "blue": {
        "victory": true,
        "totalGold": 56800,
        "players": [
            {
                "team": "PVB",
                "name": "Zeros",
                "stats": {
                    "champion": "Jayce",
                    "kills": 5,
                    "deaths": 3,
                    "assists": 9,
                    "largestKillingSpree": 4,
                    "largestMultiKill": 2,
                    "firstBlood": false,
                    "totalDamageToChampions": 21500,
                    "physicalDamageToChampions": 18600,
                    "magicDamageToChampions": 2100,
                    "trueDamageToChampions": 900,
                    "totalDamageDealt": 185300,
                    "physicalDamageDealt": 164000,
                    "magicDamageDealt": 17200,
                    "trueDamageDealt": 4100,
                    "largestCriticalStrike": null,
                    "totalDamageToObjectives": 13400,
                    "totalDamageToTurrets": 7300,
                    "damageHealed": 1900,
                    "damageTaken": 13800,
                    "physicalDamageTaken": 7900,
                    "magicDamageTaken": 4700,
                    "trueDamageTaken": 1200,
                    "wardsPlaced": 13,
                    "wardsDestroyed": 3,
                    "stealthWardsPurchased": null,
                    "controlWardsPurchased": 4,
                    "goldEarned": 12700,
                    "goldSpent": 11300,
                    "minionsKilled": 212,
                    "neutralMinionsKilled": 33,
                    "neutralMinionsKilledInTeamsJungle": 9,
                    "neutralMinionsKilledInEnemyJungle": 16
                }
            },
            {
                "team": "PVB",
                "name": "Meliodas",
                "stats": {
                    "champion": "Olaf",
                    "kills": 3,
                    "deaths": 1,
                    "assists": 7,
                    "largestKillingSpree": 3,
                    "largestMultiKill": 2,
                    "firstBlood": false,
                    "totalDamageToChampions": 6300,
                    "physicalDamageToChampions": 3900,
                    "magicDamageToChampions": 200,
                    "trueDamageToChampions": 2200,
                    "totalDamageDealt": 149800,
                    "physicalDamageDealt": 101400,
                    "magicDamageDealt": 27700,
                    "trueDamageDealt": 20700,
                    "largestCriticalStrike": null,
                    "totalDamageToObjectives": 15700,
                    "totalDamageToTurrets": 1500,
                    "damageHealed": 9100,
                    "damageTaken": 21400,
                    "physicalDamageTaken": 15500,
                    "magicDamageTaken": 5300,
                    "trueDamageTaken": 600,
                    "wardsPlaced": 34,
                    "wardsDestroyed": 22,
                    "stealthWardsPurchased": null,
                    "controlWardsPurchased": 14,
                    "goldEarned": 10400,
                    "goldSpent": 9100,
                    "minionsKilled": 41,
                    "neutralMinionsKilled": 121,
                    "neutralMinionsKilledInTeamsJungle": 58,
                    "neutralMinionsKilledInEnemyJungle": 31
                }
            },
            {
                "team": "PVB",
                "name": "Naul",
                "stats": {
                    "champion": "Orianna",
                    "kills": 8,
                    "deaths": 0,
                    "assists": 6,
                    "largestKillingSpree": 8,
                    "largestMultiKill": 3,
                    "firstBlood": false,
                    "totalDamageToChampions": 12500,
                    "physicalDamageToChampions": 400,
                    "magicDamageToChampions": 12100,
                    "trueDamageToChampions": 0,
                    "totalDamageDealt": 153400,
                    "physicalDamageDealt": 16100.000000000002,
                    "magicDamageDealt": 137300,
                    "trueDamageDealt": 0,
                    "largestCriticalStrike": null,
                    "totalDamageToObjectives": 11000,
                    "totalDamageToTurrets": 7600,
                    "damageHealed": 3200,
                    "damageTaken": 7700,
                    "physicalDamageTaken": 2600,
                    "magicDamageTaken": 4600,
                    "trueDamageTaken": 400,
                    "wardsPlaced": 13,
                    "wardsDestroyed": 4,
                    "stealthWardsPurchased": null,
                    "controlWardsPurchased": 5,
                    "goldEarned": 13400,
                    "goldSpent": 11300,
                    "minionsKilled": 230,
                    "neutralMinionsKilled": 24,
                    "neutralMinionsKilledInTeamsJungle": 16,
                    "neutralMinionsKilledInEnemyJungle": 1
                }
            },
            {
                "team": "PVB",
                "name": "BigKoro",
                "stats": {
                    "champion": "Kaisa",
                    "kills": 6,
                    "deaths": 0,
                    "assists": 7,
                    "largestKillingSpree": 6,
                    "largestMultiKill": 2,
                    "firstBlood": true,
                    "totalDamageToChampions": 11200,
                    "physicalDamageToChampions": 8400,
                    "magicDamageToChampions": 2500,
                    "trueDamageToChampions": 200,
                    "totalDamageDealt": 145100,
                    "physicalDamageDealt": 121300,
                    "magicDamageDealt": 22100,
                    "trueDamageDealt": 1600,
                    "largestCriticalStrike": 555,
                    "totalDamageToObjectives": 19000,
                    "totalDamageToTurrets": 9300,
                    "damageHealed": 1600,
                    "damageTaken": 9600,
                    "physicalDamageTaken": 4500,
                    "magicDamageTaken": 5100,
                    "trueDamageTaken": 0,
                    "wardsPlaced": 15,
                    "wardsDestroyed": 13,
                    "stealthWardsPurchased": null,
                    "controlWardsPurchased": 6,
                    "goldEarned": 12800,
                    "goldSpent": 11300,
                    "minionsKilled": 183,
                    "neutralMinionsKilled": 35,
                    "neutralMinionsKilledInTeamsJungle": 10,
                    "neutralMinionsKilledInEnemyJungle": 12
                }
            },
            {
                "team": "PVB",
                "name": "Palette",
                "stats": {
                    "champion": "Nautilus",
                    "kills": 0,
                    "deaths": 2,
                    "assists": 13,
                    "largestKillingSpree": 0,
                    "largestMultiKill": 0,
                    "firstBlood": false,
                    "totalDamageToChampions": 3500,
                    "physicalDamageToChampions": 800,
                    "magicDamageToChampions": 2200,
                    "trueDamageToChampions": 500,
                    "totalDamageDealt": 30600,
                    "physicalDamageDealt": 8500,
                    "magicDamageDealt": 9200,
                    "trueDamageDealt": 12800,
                    "largestCriticalStrike": null,
                    "totalDamageToObjectives": 200,
                    "totalDamageToTurrets": 200,
                    "damageHealed": 1400,
                    "damageTaken": 10500,
                    "physicalDamageTaken": 3100,
                    "magicDamageTaken": 6500,
                    "trueDamageTaken": 900,
                    "wardsPlaced": 51,
                    "wardsDestroyed": 9,
                    "stealthWardsPurchased": null,
                    "controlWardsPurchased": 18,
                    "goldEarned": 7500,
                    "goldSpent": 6300,
                    "minionsKilled": 50,
                    "neutralMinionsKilled": null,
                    "neutralMinionsKilledInTeamsJungle": null,
                    "neutralMinionsKilledInEnemyJungle": null
                }
            }
        ]
    },
    "red": {
        "victory": false,
        "totalGold": 43700,
        "players": [
            {
                "team": "VEG",
                "name": "BOSS",
                "stats": {
                    "champion": "Irelia",
                    "kills": 2,
                    "deaths": 4,
                    "assists": 4,
                    "largestKillingSpree": 2,
                    "largestMultiKill": 1,
                    "firstBlood": false,
                    "totalDamageToChampions": 6400,
                    "physicalDamageToChampions": 3100,
                    "magicDamageToChampions": 3100,
                    "trueDamageToChampions": 100,
                    "totalDamageDealt": 131700,
                    "physicalDamageDealt": 116400,
                    "magicDamageDealt": 12800,
                    "trueDamageDealt": 2500,
                    "largestCriticalStrike": null,
                    "totalDamageToObjectives": 2900,
                    "totalDamageToTurrets": 600,
                    "damageHealed": 4200,
                    "damageTaken": 19000,
                    "physicalDamageTaken": 12500,
                    "magicDamageTaken": 5800,
                    "trueDamageTaken": 700,
                    "wardsPlaced": 11,
                    "wardsDestroyed": 6,
                    "stealthWardsPurchased": null,
                    "controlWardsPurchased": 4,
                    "goldEarned": 9800,
                    "goldSpent": 9600,
                    "minionsKilled": 211,
                    "neutralMinionsKilled": 17,
                    "neutralMinionsKilledInTeamsJungle": 14,
                    "neutralMinionsKilledInEnemyJungle": null
                }
            },
            {
                "team": "VEG",
                "name": "AHaHaCiK",
                "stats": {
                    "champion": "RekSai",
                    "kills": 1,
                    "deaths": 4,
                    "assists": 4,
                    "largestKillingSpree": 1,
                    "largestMultiKill": 1,
                    "firstBlood": false,
                    "totalDamageToChampions": 7000,
                    "physicalDamageToChampions": 5900,
                    "magicDamageToChampions": 0,
                    "trueDamageToChampions": 1100,
                    "totalDamageDealt": 107600,
                    "physicalDamageDealt": 81400,
                    "magicDamageDealt": 3200,
                    "trueDamageDealt": 23000,
                    "largestCriticalStrike": null,
                    "totalDamageToObjectives": 20100,
                    "totalDamageToTurrets": 600,
                    "damageHealed": 8500,
                    "damageTaken": 19300,
                    "physicalDamageTaken": 13500,
                    "magicDamageTaken": 4100,
                    "trueDamageTaken": 1700,
                    "wardsPlaced": 26,
                    "wardsDestroyed": 14,
                    "stealthWardsPurchased": null,
                    "controlWardsPurchased": 7,
                    "goldEarned": 8800,
                    "goldSpent": 7900,
                    "minionsKilled": 42,
                    "neutralMinionsKilled": 86,
                    "neutralMinionsKilledInTeamsJungle": 51,
                    "neutralMinionsKilledInEnemyJungle": 11
                }
            },
            {
                "team": "VEG",
                "name": "Nomanz",
                "stats": {
                    "champion": "Zoe",
                    "kills": 2,
                    "deaths": 4,
                    "assists": 0,
                    "largestKillingSpree": 2,
                    "largestMultiKill": 2,
                    "firstBlood": false,
                    "totalDamageToChampions": 10300,
                    "physicalDamageToChampions": 300,
                    "magicDamageToChampions": 8600,
                    "trueDamageToChampions": 1300,
                    "totalDamageDealt": 138200,
                    "physicalDamageDealt": 11700,
                    "magicDamageDealt": 108600,
                    "trueDamageDealt": 17900,
                    "largestCriticalStrike": null,
                    "totalDamageToObjectives": 3500,
                    "totalDamageToTurrets": 2200,
                    "damageHealed": 1000,
                    "damageTaken": 12200,
                    "physicalDamageTaken": 6400,
                    "magicDamageTaken": 5600,
                    "trueDamageTaken": 200,
                    "wardsPlaced": 10,
                    "wardsDestroyed": 7,
                    "stealthWardsPurchased": null,
                    "controlWardsPurchased": 2,
                    "goldEarned": 9900,
                    "goldSpent": 8800,
                    "minionsKilled": 210,
                    "neutralMinionsKilled": null,
                    "neutralMinionsKilledInTeamsJungle": null,
                    "neutralMinionsKilledInEnemyJungle": null
                }
            },
            {
                "team": "VEG",
                "name": "Gadget",
                "stats": {
                    "champion": "Heimerdinger",
                    "kills": 1,
                    "deaths": 5,
                    "assists": 1,
                    "largestKillingSpree": 1,
                    "largestMultiKill": 1,
                    "firstBlood": false,
                    "totalDamageToChampions": 10000,
                    "physicalDamageToChampions": 300,
                    "magicDamageToChampions": 9700,
                    "trueDamageToChampions": 0,
                    "totalDamageDealt": 116400,
                    "physicalDamageDealt": 9100,
                    "magicDamageDealt": 107300,
                    "trueDamageDealt": 0,
                    "largestCriticalStrike": null,
                    "totalDamageToObjectives": 6900,
                    "totalDamageToTurrets": 2700,
                    "damageHealed": 700,
                    "damageTaken": 10200,
                    "physicalDamageTaken": 6000,
                    "magicDamageTaken": 4000,
                    "trueDamageTaken": 100,
                    "wardsPlaced": 7,
                    "wardsDestroyed": 6,
                    "stealthWardsPurchased": null,
                    "controlWardsPurchased": 1,
                    "goldEarned": 9100,
                    "goldSpent": 8900,
                    "minionsKilled": 189,
                    "neutralMinionsKilled": 2,
                    "neutralMinionsKilledInTeamsJungle": null,
                    "neutralMinionsKilledInEnemyJungle": null
                }
            },
            {
                "team": "VEG",
                "name": "SaNTaS",
                "stats": {
                    "champion": "Galio",
                    "kills": 0,
                    "deaths": 5,
                    "assists": 4,
                    "largestKillingSpree": 0,
                    "largestMultiKill": 0,
                    "firstBlood": false,
                    "totalDamageToChampions": 3300,
                    "physicalDamageToChampions": 100,
                    "magicDamageToChampions": 2700,
                    "trueDamageToChampions": 500,
                    "totalDamageDealt": 32100,
                    "physicalDamageDealt": 2700,
                    "magicDamageDealt": 16600,
                    "trueDamageDealt": 12900,
                    "largestCriticalStrike": null,
                    "totalDamageToObjectives": 300,
                    "totalDamageToTurrets": 300,
                    "damageHealed": 1600,
                    "damageTaken": 14400,
                    "physicalDamageTaken": 11700,
                    "magicDamageTaken": 1600,
                    "trueDamageTaken": 1100,
                    "wardsPlaced": 43,
                    "wardsDestroyed": 6,
                    "stealthWardsPurchased": null,
                    "controlWardsPurchased": 15,
                    "goldEarned": 6100,
                    "goldSpent": 5600,
                    "minionsKilled": 54,
                    "neutralMinionsKilled": null,
                    "neutralMinionsKilledInTeamsJungle": null,
                    "neutralMinionsKilledInEnemyJungle": null
                }
            }
        ]
    }
}

let Promise = require('bluebird');
let fs = Promise.promisifyAll(require('fs'));

function calculateDividends(data){
    if (data === undefined || data.length == 0) {
    // array empty or does not exist
    }
    else{
        let stream = fs.createWriteStream("dividend.txt", {flags:'a'});
        let posNum = 0; 
        for(player in data.blue.players){
            let score = masterFormula(data.blue.players[posNum], posNum, data.duration, data.blue.victory);
            stream.write("INSERT INTO `dividend` (stock_id, value) VALUES ("+data.blue.players[posNum].name + ","+ score +");\n");
            posNum++;
        }
        posNum = 0; 
        for(player in data.red.players){
            let score = masterFormula(data.red.players[posNum], posNum, data.duration, data.red.victory);
            stream.write("INSERT INTO `dividend` (stock_id, value) VALUES ("+data.red.players[posNum].name + ","+ score +");\n");
            posNum++;
        }
    }
}


function masterFormula(player, posNum, duration, victory){
    let topMap = new Map();
    topMap.set("kills",2)
        .set("deaths",-1)
        .set("assists",1)
        .set("largestKillingSpree",1)
        .set("largestMultiKill",1)
        .set("totalDamageToChampions",0.0003)
        .set("totalDamageToObjectives",0.0002)
        .set("totalDamageToTurrets",0.0002)
        .set("damageHealed",0.0002)
        .set("damageTaken",0.0005)
        .set("wardsPlaced",0.2)
        .set("wardsDestroyed",0.3)
        .set("controlWardsPurchased",0.4)
        .set("minionsKilled",0.02)
        .set("neutralMinionsKilled",0.01)
        .set("neutralMinionsKilledInTeamsJungle",0.01)
        .set("neutralMinionsKilledInEnemyJungle",0.05)

    let jngMap = new Map();
    jngMap.set("kills",1)
        .set("deaths",-1)
        .set("assists",1.5)
        .set("largestKillingSpree",1)
        .set("largestMultiKill",1)
        .set("totalDamageToChampions",0.0003)
        .set("totalDamageToObjectives",0.0002)
        .set("totalDamageToTurrets",0.0001)
        .set("damageHealed",0.0002)
        .set("damageTaken",0.0002)
        .set("wardsPlaced",0.2)
        .set("wardsDestroyed",0.3)
        .set("controlWardsPurchased",0.4)
        .set("minionsKilled",0.02)
        .set("neutralMinionsKilled",0.01)
        .set("neutralMinionsKilledInTeamsJungle",0.01)
        .set("neutralMinionsKilledInEnemyJungle",0.1)

    let midMap = new Map();
    midMap.set("kills",2)
        .set("deaths",-1)
        .set("assists",1)
        .set("largestKillingSpree",1)
        .set("largestMultiKill",1)
        .set("totalDamageToChampions",0.0005)
        .set("totalDamageToObjectives",0.0002)
        .set("totalDamageToTurrets",0.0001)
        .set("damageHealed",0.0002)
        .set("damageTaken",0.0002)
        .set("wardsPlaced",0.2)
        .set("wardsDestroyed",0.3)
        .set("controlWardsPurchased",0.4)
        .set("minionsKilled",0.03)
        .set("neutralMinionsKilled",0.01)
        .set("neutralMinionsKilledInTeamsJungle",0.01)
        .set("neutralMinionsKilledInEnemyJungle",0.05)

    let botMap = new Map();
    botMap.set("kills",2)
        .set("deaths",-1)
        .set("assists",1)
        .set("largestKillingSpree",1)
        .set("largestMultiKill",1)
        .set("totalDamageToChampions",0.0005)
        .set("totalDamageToObjectives",0.0002)
        .set("totalDamageToTurrets",0.0001)
        .set("damageHealed",0.0002)
        .set("damageTaken",0.0002)
        .set("wardsPlaced",0.2)
        .set("wardsDestroyed",0.3)
        .set("controlWardsPurchased",0.4)
        .set("minionsKilled",0.03)
        .set("neutralMinionsKilled",0.01)
        .set("neutralMinionsKilledInTeamsJungle",0.01)
        .set("neutralMinionsKilledInEnemyJungle",0.05)

    let supMap = new Map();
    supMap.set("kills",1)
        .set("deaths",-1)
        .set("assists",1.5)
        .set("largestKillingSpree",1)
        .set("largestMultiKill",1)
        .set("totalDamageToChampions",0.0003)
        .set("totalDamageToObjectives",0.0002)
        .set("totalDamageToTurrets",0.0001)
        .set("damageHealed",0.0005)
        .set("damageTaken",0.0004)
        .set("wardsPlaced",0.3)
        .set("wardsDestroyed",0.5)
        .set("controlWardsPurchased",0.4)
        .set("minionsKilled",0.01)
        .set("neutralMinionsKilled",0.001)
        .set("neutralMinionsKilledInTeamsJungle",0.001)
        .set("neutralMinionsKilledInEnemyJungle",0.005)

    let dividend = 0;
    if(victory){
        dividend +=5;
    }
    //console.log(player);
    for(stat in player.stats) {
        //console.log(stat+"hi");
        if(topMap.has(stat)&&player.stats[stat]!=undefined){
            switch(posNum) {
                case 0:
                dividend += topMap.get(stat)*parseFloat(player.stats[stat]);
                break;
                case 1:
                dividend += jngMap.get(stat)*parseFloat(player.stats[stat]);
                break;
                case 2:
                dividend += midMap.get(stat)*parseFloat(player.stats[stat]);
                break;
                case 3:
                dividend += botMap.get(stat)*parseFloat(player.stats[stat]);
                break;
                case 4:
                dividend += supMap.get(stat)*parseFloat(player.stats[stat]);
                break;
            }
            //console.log(player.stats[stat]);
            //console.log(topMap.get(stat));
            //console.log(parseFloat(topMap.get(stat))*parseFloat(player.stats[stat]));
        } 
    }
    //console.log(dividend);
    return dividend/duration*100000;
}

calculateDividends(arg);